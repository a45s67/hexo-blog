---
title: å¦‚ä½•ä¿®æ”¹ RPG éŠæˆ² - Sequel Blight è§’è‰²çš„å„é …æ•¸å€¼
date: 2023-09-16 18:01:54
tags:
- [Reverse Engineering]
cover:
- cover.jpg
---

# å‰è¨€
å»å¹´æœ‰æ®µæ™‚é–“è »é–’çš„ï¼Œåˆ’ FB æ™‚çœ‹åˆ°æœ‰äººæ¨è–¦é€™æ¬¾éŠæˆ²ï¼Œå°±ä¾†ç©ç©çœ‹ã€‚
ç©åˆ°ä¸€åŠç™¼ç¾é€™éŠæˆ²æœ‰é»è¾²ï¼Œåœ°åœ–é‚„å¾ˆå¤§è¦èµ°å¾ˆä¹…...ä½†æˆ‘åªæƒ³è¶•å¿«ç ´å®Œçœ‹åŠ‡æƒ…ã€‚
æœ€å¾Œå—ä¸äº†äº†ï¼Œæ±ºå®šç›´æ¥é–‹ CE æ”¹æ•¸æ“šã€‚åœ¨é€†å‘çš„éç¨‹ä¸­ï¼Œæ„å¤–çš„å…‹æœä¸å°‘å•é¡Œï¼Œå­¸åˆ°äº†ä¸å°‘ï¼Œæ–¼æ˜¯æ±ºå®šè¨˜éŒ„ä¸‹ä¾†ã€‚

é€™ç¯‡æ–‡ç« æœƒä»¥é€™æ¬¾éŠæˆ²çš„å¯¦éš›æƒ…å¢ƒç‚ºä¾‹ï¼Œè¬›è¿°æˆ‘å¦‚ä½•æ¨æ¸¬ã€æ‰¾å°‹åˆ‡å…¥é»ï¼Œå„ç¨® CE çš„æ“ä½œå°æŠ€å·§ï¼Œå†åˆ° CE åšä¸ä¸‹å»æ™‚ï¼Œå¯ä»¥é€²è¡Œçš„å…¶ä»–é¸æ“‡ã€‚
æ•´å€‹éç¨‹å’Œæ“ä½œç´°ç¯€ä¸Šï¼Œæ‡‰è©²é‚„æœ‰å¾ˆå¤šèƒ½æ”¹é€²çš„é»ï¼Œè‹¥å„è·¯å¤§ç¥è·¯éï¼Œæœ‰ä¸€äº›æ„Ÿè¦ºèƒ½æ›´å¥½çš„åšæ³•ï¼Œä¹Ÿæ‡‡è«‹æ•™æ•™å°å¼Ÿ...ã€‚

# ç›®æ¨™èªªæ˜
## Sequel Blight
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-1.png 450 %}
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-3.png 450 %}
åŸºæœ¬ä¸ŠéŠæˆ²éç¨‹å°±æ˜¯è§£åŠ‡æƒ…ï¼Œè·‘åœ°åœ–æ‰“æ€ªã€å‡ç­‰æ‰“ç‹ï¼Œè§£éš±è—åœ°åœ–å’Œé“å…·ç­‰ç­‰çš„ã€‚è€Œæˆ°é¬¥æ©Ÿåˆ¶çš„éƒ¨åˆ†ï¼Œå°±æ˜¯å¸¸è¦‹çš„æ“æ§è…³è‰²è·‘åœ°åœ–ï¼Œæ’åˆ°æ€ªç‰©æ™‚æœƒé€²å…¥æˆ°é¬¥å›åˆé€™æ¨£ã€‚
é‚„æœ‰ä¸å°‘æ²’æåˆ°ï¼Œç¸½ä¹‹é€™éŠæˆ²çš„å…ƒç´ å¾ˆè±å¯Œï¼Œåƒæ˜¯å¯ä»¥è½‰çš„è·æ¥­å°±æœ‰ 10 å¹¾å€‹ï¼Œç•¶ RPG ç©çš„è©±ç¢ºå¯¦ä¹Ÿè »è€ç©çš„ã€‚

> é›–ç„¶éŠæˆ²æœ¬èº«æ˜¯æˆäººå‘ï¼Œä½†é€™ç¯‡æ–‡ç« ä¸å«ä»»ä½•æˆäººå…§å®¹ï¼Œå¯ä»¥æ”¾å¿ƒç€è¦½ğŸ˜‚ã€‚

## ç›®æ¨™
æˆ‘çš„è¨´æ±‚æ˜¯ç›¡å¿«çµæŸæ¯ä¸€å ´æˆ°é¬¥ï¼Œä¸¦ä¸”æ¸›å°‘è·‘åœ–çš„æ™‚é–“ï¼Œæ•…è¦åšçš„äº‹æœ‰ä»¥ä¸‹å¹¾é»ï¼š
1. ä¿®æ”¹è§’è‰²æ•¸å€¼ï¼Œå¦‚æ”»æ“ŠåŠ›ã€è¡€é‡
2. èª¿æ•´åœ°åœ–äººç‰©ç§»å‹•é€Ÿåº¦ï¼Œè®“ç§»å‹•å¿«ä¸€é»

# ä¿®æ”¹è§’è‰²æ•¸å€¼
ä¿®æ”¹è§’è‰²é¢æ¿æ”»æ“ŠåŠ›ã€è¡€é‡çš„æ­¥é©Ÿ (ä»¥ä¸‹ç°¡ç¨± atkã€hp)
1. å–å¾—é€™äº›è§’è‰²æ•¸å€¼çš„ memory address
2. ç„¶å¾Œå°±å¯ä»¥ä¿®æ”¹äº†

## å–å¾—è§’è‰²æ•¸å€¼çš„ address

å¥½åƒå°±é€™éº¼ç°¡å–®ã€‚ä½†è¦æ€éº¼é€™äº›å–å¾—è§’è‰²æ•¸å€¼å‘¢ï¼Ÿç›´æ¥æœå°‹æœƒç™¼ç¾æ‰¾ä¸åˆ°é€™äº›å€¼ï¼Œæ–¼æ˜¯çŒœæ¸¬é€™äº›å€¼å­˜åˆ° memory å‰æœ‰è™•ç†éã€‚(å¦‚ä¸‹åœ–ï¼Œæœå°‹æ”»æ“ŠåŠ› 302ï¼Œéæ¿¾å¹¾æ¬¡å¾Œæœƒç™¼ç¾æœå°‹çµæœä¸€ç‰‡ç©º)
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-4.png 450 %} 

æ¨æ¸¬é€™é¡å‹çš„æ•¸å€¼ï¼Œæ‡‰è©²æ˜¯ç”±è§’è‰²åŸºç¤æ•¸å€¼ã€è·æ¥­åŠ æˆã€è£å‚™åŠ æˆç­‰ç­‰åŠ ç¸½èµ·ä¾†çš„ï¼Œç›®æ¨™æ”¾åœ¨è§’è‰²åŸºç¤æ•¸å€¼çš„è©±ï¼Œç”±æ–¼æ²’è¾¦æ³•çŸ¥é“ç¢ºåˆ‡æ•¸å€¼ç‚ºä½•ï¼Œæœå°‹çš„æ–¹æ³•æœƒè®Šæˆï¼šæœå°‹ unknown value -> å›éŠæˆ²è®Šå‹•è§’è‰²èƒ½åŠ›å€¼ -> éæ¿¾å‡ºè®Šå‹•çš„ value -> å›éŠæˆ²è®Šå‹•èƒ½åŠ›å€¼ -> ... (ç„¡é™ loop)ã€‚
ä½†æ˜¯ï¼Œé€™æµç¨‹æœ‰å€‹ bugï¼Œæˆ‘æƒ³ä¸åˆ°è¦æ€éº¼è®Šå‹•è§’è‰²åŸºç¤èƒ½åŠ›å€¼ï¼Œè©±èªªèƒ½æƒ³è®Šå°±è®Šçš„è©±æˆ‘ä¹Ÿä¸ç”¨ CE äº†ã€‚
å¡äº†ä¸€æ®µæ™‚é–“å¾Œï¼Œçªç„¶æƒ³åˆ°ï¼Œåœ¨éŠæˆ²é€²è¡Œçš„éç¨‹ä¸­æˆ‘æœ‰å–å¾—ä¸€äº›æå‡èƒ½åŠ›å€¼çš„è—¥æ°´ï¼Œé‹æ°£ä¸éŒ¯ï¼Œé€™é‚Šç›´æ¥æ‹¿ä¾†è©¦è©¦ã€‚
ä»¥æ´»åŠ›ä¹‹æ°´(æ•ˆæœæ˜¯sp+5)ç‚ºä¾‹ï¼Œæµç¨‹æ˜¯å…ˆå–å¾—é€™é“å…·æ•¸é‡çš„ addressï¼Œç„¶å¾Œä¸€å£æ°£æŠŠæ´»åŠ›ä¹‹æ°´æ•¸é‡èª¿å¤§ï¼Œå†æ…¢æ…¢è©¦è§’è‰²èƒ½åŠ›å€¼ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-5.png 450 %}
(éæ¿¾æ–¹æ³•åŸºæœ¬ä¸Šå°±æ˜¯ unknown value -> decreased value -> decreased value ...)

æŠŠå¹¾å€‹çœ‹èµ·ä¾†å¾ˆåƒçš„ address æŠ“ä¸‹ä¾†ï¼Œéš¨ä¾¿æ”¹å€‹æ•¸å­—æ¸¬è©¦ä¸€ä¸‹ï¼Œç¢ºèª `0x0E481A8` å°±æ˜¯æ´»åŠ›è—¥æ°´çš„æ•¸é‡ï¼ŒåŒæ™‚é‚„èƒ½ç™¼ç¾ä¸€ä»¶äº‹ï¼Œè¨˜æ†¶é«”ä¸­å¯¦éš›çš„æ•¸å­—æ˜¯ `2x+1`ï¼Œä¾‹å¦‚æˆ‘è—¥æ°´å‰© 4 ç“¶æ™‚ï¼Œè¨˜æ†¶é«”å…§å®¹ç‚º 9ï¼Œæ¨æ¸¬æ”»æ“ŠåŠ›ã€è¡€é‡ä¹Ÿæ˜¯åŒç†ã€‚
ç¾åœ¨æ‹¿æ´»åŠ›è—¥æ°´ç‹‚åŠ åœ¨æ‹‰æ¯”èº«ä¸Šï¼Œéæ¿¾å‡º `0x14F53A24` æ˜¯äººç‰©åŸºç¤ sp çš„ä½ç½®ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-6.png 450 %}

## ä½¿ç”¨ Poninter Scan æ‰¾å‡ºæŒ‡å‘ address çš„ pointer
æ¥ä¸‹ä¾†æœ‰å¹¾æ¢è·¯å¯ä»¥èµ°
1. ç”±æ–¼äººç‰©å±¬æ€§(hp, sp, atk ç­‰ç­‰)æ‡‰è©²æœƒå®£å‘Šåœ¨åŒä¸€å€‹ stuct å…§ï¼Œæ•… hpã€atk çš„ address æ‡‰è©²åœ¨ sp é™„è¿‘ã€‚å°é€™é™„è¿‘çš„å€¼äº‚æ”¹ä¸€éï¼Œçœ‹çœ‹å“ªå€‹æ˜¯ hp, atkã€‚
2. é‚„æ²’æƒ³åˆ°...(å–®ç´”è¦ºå¾—é‚„èƒ½æƒ³åˆ°å…¶ä»–æ¢è·¯)

ç‚ºäº†é€²è¡Œç¬¬ä¸€å€‹æ–¹æ³•ï¼Œå¿…é ˆå…ˆæŠŠ sp çš„ pointer å­˜ä¸‹ä¾†ï¼Œé¿å…æ”¹å£ struct é€ æˆéŠæˆ² crashï¼ŒéŠæˆ²é‡é–‹å¾Œå„ç‰©ä»¶çš„ address é€šå¸¸éƒ½æœƒè¢«é‡åˆ†é…ä¸€æ¬¡ï¼Œæœ‰å­˜ä¸‹å¯¦éš›çš„ pointer æ‰ä¸æœƒè¦å†é‡æ‰¾ä¸€é sp çš„ addressã€‚
é€™æ™‚å°±è¦ç”¨åˆ° Cheat Engine çš„å±ŒåŠŸèƒ½äº† - **Pointer Scan** (åœ¨ Memory view è¦–çª—çš„ Tools é¸å–®ä¸­)ï¼Œ

ç°¡å–®ä¾†èªªï¼Œå°±æ˜¯æƒä¸€é`0x14F53A24`ï¼ŒCE æœƒæ‰¾å‡ºæ‰€æœ‰æŒ‡å‘åˆ°é€™ä½ç½®çš„ pointerï¼Œæ¥è‘—æŠŠéŠæˆ²é—œæ‰é‡é–‹ï¼ŒRescan memory å‡ºé‚„æ˜¯æœ‰æ•ˆçš„ pointerï¼Œå¦‚ä¸‹åœ–
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-8.png 450 %}
é‡é–‹éŠæˆ²å¾Œï¼Œè·‘ä¸€æ¬¡ Rescan memoryï¼Œéæ¿¾å‡ºæ­£ç¢ºçš„ pointerã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-7.png 450 %}

## ä½¿ç”¨ dissect struct è§€å¯Ÿå‘¨é­è®Šæ•¸
æ¥ä¸‹ä¾†å°±å¯ä»¥é–‹å§‹å¤§è†½çš„äº‚æ”¹ memory äº†ï¼Œè§€å¯Ÿä¸Šä¸€æ­¥å¾ˆå±Œçš„ pointer scan çµæœï¼Œå¯ä»¥æ³¨æ„åˆ° sp (`0x0EF7A374`)ä¼¼ä¹ä½æ–¼ pointer æŒ‡å‘çš„ address å† +4 çš„ä½ç½®ï¼Œå¼·çƒˆæ‡·ç–‘é€™ address æ˜¯æ‹‰æ¯”çš„äººç‰©å±¬æ€§ structï¼Œä¸Ÿå» dissect struct çœ‹ä¸€ä¸‹ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-9.png 450 %}
å› ç‚ºè§’è‰²ç‹€æ…‹çš„å‘ˆç¾æ˜¯ä¸€æ¢ hp ä¸€æ¢ spï¼Œè‹¥ç¬¬äºŒå€‹ value (offset +4) æ˜¯ spï¼Œé‚£ç¬¬ä¸€å€‹ value (offset +0) æ‡‰è©²æ˜¯ hpï¼Œä¾æ­¤é¡æ¨ä¸¦æ¸¬è©¦ç¢ºèªå¾Œï¼Œé€™ struct çš„ member æ‡‰è©²å¦‚ä¸‹ï¼š
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-10.png 450 %}
``` c++
struct character_status {
    int hp;
    int sp;
    int atk;
    int def;
    int matk;
    int mdef;
    int spd;
    int luk;
};
```

æ•´ç†ä¸€ä¸‹ Cheat Table(ä»¥ä¸‹ä»¥ CT ä»£ç¨±)ï¼ŒæŠŠ hpã€sp ä¹‹é¡çš„è¨˜ä¸‹ä¾†ï¼Œé€™è£¡åˆè¦å†æåˆ° CE çš„ä¸€å€‹ featureï¼Œæˆ‘å€‘å¯ä»¥æ–°å¢ä¸€å€‹ addressï¼Œaddress å¯« +0, +4 ä¹‹é¡çš„ offset æè¿°ï¼Œç„¶å¾Œç”¨æ»‘é¼ æŠŠå®ƒæ‹‰åˆ°åšç‚º base address çš„ pointer ä¸‹ï¼Œé€™å€‹ address å°±æœƒè‡ªå‹•æŠŠ base address åŠ ä¸Šä¾†ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-11.png 450 %}
ç¾åœ¨æˆ‘å€‘ç²å¾—äº†ä»£è¡¨ rabi ç‹€æ…‹çš„ addressï¼Œèƒ½å¤ éš¨ä¾¿æ”¹ rabi çš„æ”»æ“ŠåŠ›å’Œè¡€é‡äº†ã€‚é‚£å…¶ä»–è§’è‰²å‘¢ï¼Ÿ

å†é€šéˆä¸€æ¬¡ï¼Œä¾æ“šæ„Ÿè¦ºï¼Œrabiã€uula ç­‰ç­‰è§’è‰²æœƒæœ‰ä¸€å€‹è§’è‰²ç‰©ä»¶ï¼Œå­˜æœ‰å„ç¨® member ä»£è¡¨ç‹€æ…‹ã€é“å…·ã€è·æ¥­ç­‰ç­‰è³‡è¨Šã€‚
ç„¶å¾Œæœƒæœ‰ç©å®¶ç‰©ä»¶ï¼Œmember åŒ…æ‹¬éŠæˆ²é€²è¡Œæ™‚çš„å„ç¨®æ•¸æ“šã€å„å€‹è§’è‰²ç‰©ä»¶ç­‰ç­‰ã€‚åœ¨é€™é‚Šå‡è¨­è§’è‰²ç‰©ä»¶æœƒç”¨æŒ‡æ¨™å»å­˜ï¼Œæ‰€ä»¥ uula ç­‰è§’è‰²ç‰©ä»¶çš„æŒ‡æ¨™æ‡‰è©²éƒ½å­˜åœ¨ rabi æŒ‡æ¨™çš„æ—é‚Šï¼Œç”±æ–¼ rabi æ˜¯ç¬¬ä¸€ä½è§’è‰²ï¼Œå…¶ä»–ä¸‰ä½è§’è‰²ç†è«–ä¸Šæ˜¯åœ¨ `+4`, `+8`, `+C` çš„ä½ç½®ã€‚(ç•¶ç„¶ä¹Ÿæœ‰å¯èƒ½ member æ˜¯å®Œæ•´çš„è§’è‰²ç‰©ä»¶ï¼Œè€Œä¸æ˜¯æŒ‡æ¨™ï¼Œé‚£é€™å€‹å‡è¨­å°±ä¸æˆç«‹äº†)ã€‚
æŠŠå¯ä»¥èª¿çš„ offset éƒ½è©¦äº†ä¸€éï¼Œé‚„çœŸçš„çµ¦æˆ‘è©¦æˆåŠŸï¼ŒæŸä¸€æ®µ pointer `offset +18` ä»£è¡¨ rabiï¼Œæ”¹æˆ `offset +1B,+20,+24` å¾Œï¼Œç™¼ç¾åˆ†åˆ¥ä»£è¡¨å…¶ä»–ä¸‰ä½å¥³è§’ï¼Œç¾åœ¨æœ‰è¾¦æ³•ä»»æ„ä¿®æ”¹ 4 ä½å¥³ä¸»è§’çš„åŸºæœ¬æ•¸å€¼äº†ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-12.png 450 %}

é‹æ°£å¾ˆå¥½ï¼Œçµ¦æˆ‘çŒœä¸­ï¼Œçœä¸‹äº†é‡æ–°æ‰¾æŒ‡æ¨™çš„æ™‚é–“...
> å…¶å¯¦ç•¶æ™‚æˆ‘ä¸¦æ²’æœ‰é€šéˆé€™éº¼å¤šï¼Œæ‰¾åˆ°ä¸€å€‹è§’è‰²å¾Œå°±æ²’åšä¸‹å»äº†ï¼Œåœ¨å¯«é€™ç¯‡æ–‡ç« æŠŠæµç¨‹é‡è·‘ä¸€éå¾Œï¼Œæ‰æƒ³åˆ°å¥½åƒå¯ä»¥é€™æ¨£è©¦è©¦ã€‚

# ä¿®æ”¹ç§»å‹•é€Ÿåº¦
ç•¶äººç‰©åœ¨åœ°åœ–ä¸Šç§»å‹•æ™‚ï¼Œæœ‰å…©ç¨®ç‹€æ…‹ï¼Œä¸€èˆ¬æƒ…æ³ä¸‹æ˜¯æ­£å¸¸ç§»å‹•é€Ÿåº¦ï¼ŒæŒ‰ä½ shift æ™‚æ˜¯ç·©æ…¢ç§»å‹•é€Ÿåº¦ã€‚æˆ‘çš„ç›®æ¨™å°±æ˜¯æŠŠæ­£å¸¸çš„ç§»å‹•é€Ÿåº¦æ”¹å¿«ä¸€é»ã€‚
> **2st round ç™¼ç¾çš„äº‹**
> å¾Œä¾†é‡æ–°å¯©è¦–ä¸€éï¼Œå¯¦éš›ä¸Šæ˜¯åˆ†æˆä¸€èˆ¬é€Ÿåº¦å’Œè¡åˆºï¼Œé€™éŠæˆ²é€šå¸¸éƒ½åœ¨è¡åˆºç‹€æ…‹ï¼ŒæŒ‰ä½ shift æ™‚æœƒå›åˆ°ä¸€èˆ¬é€Ÿåº¦ã€‚å¦‚æœäº‹å…ˆæœ‰é‡æ¸…å‡ºé€™ä»¶äº‹ï¼Œèªªä¸å®šæˆ‘æ¥ä¸‹ä¾†çš„é€†å‘éç¨‹æœƒç›´æ¥é †åˆ©å¥½å¹¾å€...ğŸ¥¹ã€‚

è©²å®Œæˆçš„æ­¥é©Ÿæœ‰
1. å–å¾—äººç‰©ç§»å‹•é€Ÿåº¦çš„ address
2. ç„¶å¾Œå°±å¯ä»¥ä¿®æ”¹äº†

## éæ¿¾å‡ºå¯èƒ½ä»£è¡¨äººç‰©é€Ÿåº¦çš„ address
æˆ‘å€‘ä¸çŸ¥é“ç§»å‹•é€Ÿåº¦çš„æ•¸å­—æ˜¯å¤šå°‘ï¼Œæ‰€ä»¥å†ä¾†ä¸€æ¬¡ unknown value æœç´¢å¤§æ³•ï¼š
unknown value-> shift æŒ‰ä½ç§»å‹•äººç‰© -> changed value -> æ”¾æ‰ shift ç§»å‹•äººç‰© -> changed value -> éš¨ä¾¿åšå¹¾å€‹å‹•ä½œå¾Œç§»å‹•äººç‰© -> unchanged value -> ... (infinite loop)

æ‰¾åˆ°äº† 3 å€‹çœ‹èµ·ä¾†å¾ˆåƒæ˜¯ç§»å‹•é€Ÿåº¦çš„å€¼ï¼Œæ­£å¸¸æ™‚æ˜¯ 11ï¼ŒæŒ‰ä¸‹ shift æœƒè®Šæˆ 9ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-13.png 450 %}
ä½†æ˜¯æŠŠé€™ 3 å€‹ address çš„å€¼é–åœ¨ 11ï¼Œæœƒç™¼ç¾ä¸€é»æ•ˆæœéƒ½æ²’æœ‰ã€‚
æ¨æ¸¬é–å€¼ç„¡æ•ˆçš„åŸå› ï¼Œæ˜¯é€™ä¸æ˜¯æ­£ç¢ºçš„ addressï¼Œå¯èƒ½åªæ˜¯è™•ç†äººç‰©é€Ÿåº¦æ™‚ï¼Œæš«æ™‚åˆ†é…çš„ variable è€Œå·²ï¼Œè€Œ CE çš„é–å€¼å…¶å¯¦æ˜¯æ¯ 100ms é–ä¸€æ¬¡ (å¯å¾è¨­å®šèª¿æ•´)ï¼Œæ‰€ä»¥é–ä¸åˆ°ã€‚
æˆ‘çŒœé‚è¼¯å¯èƒ½æ˜¯é€™æ¨£ï¼š
- æ­£å¸¸é€Ÿåº¦çš„ value æ”¾åœ¨å¦å¤–ä¸€å€‹ address ä¸Šï¼Œäººç‰©ç§»å‹•æ™‚å¾é€™ address æ‹¿å€¼ï¼Œå–å¾—äººç‰©é€Ÿåº¦ã€‚
- ç•¶åµæ¸¬åˆ° shift æŒ‰ä¸‹æ™‚ï¼Œé€²å…¥å¦ä¸€å€‹é‚è¼¯ï¼Œé€™é‚è¼¯æœ‰å…©ç¨®å¯èƒ½
   - å¯èƒ½æ˜¯æ­£å¸¸æƒ…æ³ä¸‹çš„äººç‰©é€Ÿåº¦ -2
   - æˆ–æ˜¯ shift çš„é€Ÿåº¦ä¹Ÿæ˜¯æ”¾åœ¨å¦å¤–ä¸€å€‹ address å­˜è‘—ã€‚

## è¿½æŸ¥å­˜å–é€™äº› address çš„ä»£ç¢¼æ®µ
æ¥ä¸‹ä¾†æœƒä½¿ç”¨å…©å€‹ CE çš„å±ŒåŠŸèƒ½ï¼š
1. `Find out what access this address`
2. `Find out what writes to this address`

{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-14.png 450 %}

ä¾æ“šç›®å‰çš„ç‹€æ³ï¼Œæˆ‘çŒœé€™ 3 å€‹ address æœ‰å…©ç¨®å¯èƒ½
1. å¾çœŸæ­£çš„æ­£å¸¸é€Ÿåº¦æˆ– shift é€Ÿåº¦çš„ variable æ‹¿å€¼ï¼Œè¤‡è£½éä¾†çš„ï¼Œä½œç‚ºäººç‰©é€Ÿåº¦ç›¸é—œè™•ç†çš„ tmp value : ä½¿ç”¨ Find out what writes to this address
2. äººç‰©çœŸçš„è¦ç§»å‹•æ™‚ï¼ŒçœŸçš„æœƒå¥—ç”¨çš„å¯¦éš›é€Ÿåº¦çš„ value : ä½¿ç”¨ Find out what access to this address

ä¸å¦‚å°±å…ˆè¿½ç¬¬ 2 ç¨®çš„ç‹€æ³çœ‹çœ‹ï¼Œè¿½äº†ç™¼ç¾éƒ½æ˜¯åŒä¸€æ®µç¨‹å¼ç¢¼åœ¨è™•ç† = =...ä¸è«–æˆ‘æ˜¯å¦æœ‰æŒ‰ shiftã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-15.png 450 %}
é‚£ç¬¬ 1 ç¨®å‘¢ï¼Œä¹Ÿå¯ç™¼ç¾ 3 å€‹ address éƒ½æ˜¯ç›¸åŒçš„å¹¾æ®µç¨‹å¼ç¢¼åœ¨å­˜å–...ä¸è«–æˆ‘æ˜¯å¦æœ‰æŒ‰ shiftã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-16.png 450 %}

è¿½ä¸€ä¸‹ç¬¬ 1 ç¨®çš„ä»£ç¢¼æ®µï¼Œçœ‹èµ·ä¾† eax æ˜¯æŒ‡å‘æŸå€‹çµæ§‹ï¼Œä¾æ“š ecx,edx å€¼åˆ¤æ–·è¦å°‡ ebp (caller å‘¼å«é€™ func æ™‚å‚³å…¥çš„åƒæ•¸) å¡åˆ° eax ç‰©ä»¶ä¸­çš„å“ªä¸€å€‹ member variableã€‚
æ¨æ¸¬ eax æ‡‰è©²æ˜¯åœ°åœ–è§’è‰²çš„ "ç•¶å‰ç¬é–“ç‹€æ…‹"ï¼Œeax + 0xA * 4 æ˜¯ "ç•¶å‰é€Ÿåº¦"ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-17.png 450 %}

æ‰€ä»¥ ebp å¯èƒ½å°±æ˜¯çœŸæ­£çš„ç§»å‹•é€Ÿåº¦ï¼Œè¿½ä¸€ä¸‹ stack çœ‹çœ‹ caller æ˜¯èª°ï¼Œæœ‰å…©å€‹æ–¹æ³•
1. ä¸‹ condition æ–·é»ï¼Œçœ‹ä¸€ä¸‹æ–·é»ç™¼ç”Ÿæ™‚çš„ call stackï¼Œæ‰¾å‡º callerã€‚
2. å‰›å‰› Find out what access this address çš„ä»‹é¢ä¸­ï¼Œæœ‰ä¸€å€‹è¦–çª—æœƒé¡¯ç¤º access æ™‚çš„ stack å…§å®¹

æ”¾ä¸Šå…©ç¨®æ–¹æ³•çš„æˆªåœ–ï¼š
1. è¨­å€‹æº–ç¢ºçš„æ¢ä»¶ï¼Œé¿å…æ–·é»åˆ°é™¤äº†åˆ†é…äººç‰©é€Ÿåº¦æ™‚çš„å…¶ä»–ç‹€æ³ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-18.png 450 %}
2. æˆ–æ˜¯çœ‹ä¸€ä¸‹ access æ™‚çš„ stack å…§å®¹ï¼Œå› ç‚º CE å¾ˆå±Œï¼Œæˆ‘å€‘å¯ä»¥ä¸€çœ¼çœ‹å‡ºä¾†å“ªäº›æ˜¯æŒ‡å‘ç¨‹å¼ç¢¼æ®µçš„ï¼Œæ¯”è¼ƒæ‡¶ä¸€é»ä¸å»è¿½ stack å¤šå¤§çš„è©±ï¼Œé€šå¸¸æ¯”è¼ƒä¸Šé¢çš„é‚£ä¸€å€‹æœƒæ˜¯ç•¶å‰ func çš„ return address(åªè¦ caller åƒæ•¸ä¸æ˜¯å‚³ func pointer ä¹‹é¡çš„)ï¼Œæ–¼æ˜¯æˆ‘å€‘å°±æ‰¾åˆ° caller æ˜¯èª°äº† (`RGSS300.dll + 0x2D36E`)ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-19.png 450 %}

## è¿½æŸ¥ caller å‘¼å«é€²å…¥é€™ä»£ç¢¼æ®µæ™‚å‚³å…¥çš„åƒæ•¸
çœ‹ä¸€ä¸‹ caller é€™é‚Š (`RGSS300.dll + 0x2D36E`) æ€éº¼å‘¼å«çš„ï¼Œåæ¨å›å‘¼å« func æ™‚é€™äº› register çš„å€¼ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-20.png 450 %}
ç®—äº†æˆ‘å¥½åƒæ¨ä¸å›ä¾†å„ register çš„å€¼ï¼Œç›´æ¥ä¸‹æ–·é»ã€‚é€™è£¡ä¸‹æ–·é»æœ‰å…©å€‹æ–¹å¼
1. è¨­ condition æ–·é» (e.g. åƒæ˜¯ ECX == 0x2fc1 && EDI == 0xb ä¹‹é¡çš„ï¼Œæ³¨æ„ register è¦å¤§å¯«å¦‚ EAXï¼Œä¸è¡Œå°å¯«å¦‚ eax) 
2. åš AOB injectionï¼Œè£¡é¢å¯«å¹¾å€‹ cmp æ¢ä»¶ï¼Œæ–·é»ä¸‹åœ¨ç¬¦åˆæ¢ä»¶æ™‚æœƒèµ°åˆ°çš„æŒ‡ä»¤ä¸Š

å› ç‚ºç¬¬ 1 ç¨®çš„æ–·é»ä¸‹äº†ä¹‹å¾Œï¼ŒéŠæˆ²æœƒç¬é–“ lag åˆ°ä¸å¯æ€è­°ï¼Œæˆ‘çŒœä»–çš„ software bp æ˜¯ç”¨ lua åšçš„ã€‚æ‰€ä»¥æˆ‘æ¨è–¦ç¬¬ 2 ç¨®ï¼Œä½œæ³•å¦‚ä¸‹
1. Tools -> Auto Assemble -> template é¸ AOB injection
2. é–‹å§‹å¯« asm
``` asm
[ENABLE]
aobscanmodule(DebugNormalSpeed,RGSS300.dll,83 C0 FC 83 C2 0C 89 16 89 46 04 8B) // should be unique
alloc(newmem,$1000)

label(code)
label(return)

newmem:
  cmp edi, 0xB
  jne code
  cmp ecx, 0x2FC1 // é€™è£¡å¯ä»¥ä¸‹ä¸€å€‹æ–·é»
  jne code 
  nop // æˆ–ä¸‹åœ¨é€™è£¡ä¹Ÿè¡Œ

code:
  add eax,-04
  add edx,0C
  jmp return

DebugNormalSpeed:
  jmp newmem
  nop
return:
registersymbol(DebugNormalSpeed)

[DISABLE]

DebugNormalSpeed:
  db 83 C0 FC 83 C2 0C

unregistersymbol(DebugNormalSpeed)
dealloc(newmem)
```
3. å­˜åˆ° cheat table ä¸­

é€™æ¨£å°±å¯«å¥½äº†ä¸€å€‹ç°¡å–®çš„ injection äº†ï¼Œéš¨æ™‚å¯ä»¥é–‹å•Ÿé—œé–‰ cheat table ä¸Šä½ å‰›å¯«å¥½çš„ asm scriptã€‚
é–‹å•Ÿæ™‚ï¼ŒCE æœƒåˆ†é… asm ä¸€å¡Š memoryï¼Œä¸¦å°‡ç¬¦åˆ AOB ç‰¹å¾µçš„ç¨‹å¼æ®µæ”¹æˆ jmp åˆ°è‡ªè£½ asm çš„ addressã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-24.png 450 %}
å¤§æ¦‚å°±æ˜¯é€™æ¨£å­ï¼Œå¯ä»¥åšå¾ˆå¤šæœ‰çš„æ²’çš„äº‹æƒ…ï¼Œç¸½ä¹‹ä¸‹å€‹æ–·é»ç°¡å–®æª¢æŸ¥ä¸€ä¸‹ï¼Œå¯ä»¥çŸ¥é“
1. edi = 0xb æ™‚ ecx éƒ½æ˜¯ 0x2FC1
2. é€™æ™‚ eax = 0x326010c (è¢«å‚³å…¥ func çš„åƒæ•¸ - edi å€¼ç‚º [eax-4])

{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-25.png 450 %}
æ‰€ä»¥ `0x326010c - 4` æ˜¯ normal speed çš„ adr å—ï¼Ÿçœ‹äº†ä¸€ä¸‹é€™å€‹å€¼æœƒä¸€ç›´äº‚è·³ï¼Œçœ‹ä¾†ä¸æ˜¯ï¼Œé¦¬çš„ã€‚ä»–åªæœ‰åœ¨ `edi = 0xb` å’Œ `ecx = 0x2fc1` æ™‚æ‰æœƒæ˜¯æ­£å¸¸é€Ÿåº¦å€¼ `0xB`ã€‚
é€™è¦æ€éº¼è¿½ï¼Œæˆ‘ç ´é˜²äº†ã€‚

## å¾äººç‰© x è»¸ address åˆ‡å…¥
å› ç‚ºæš«æ™‚ä¸çŸ¥é“æ€éº¼å¾€å›è¿½äº†ï¼Œå…ˆæ”¹ç”¨å…¶ä»–æ–¹å¼è©¦è©¦ã€‚
å‡è¨­åœ°åœ–è§’è‰²çš„å„é …ç‹€æ…‹æ•¸å€¼ï¼Œæ˜¯å­˜åœ¨ä¸€å€‹ struct è£¡çš„ï¼Œmember å¯èƒ½åŒ…æ‹¬ xy è»¸ã€å¯å¦ç§»å‹•ã€å¯å¦ç„¡è¦–æ€ªç‰©ã€äººç‰©ç§»å‹•é€Ÿåº¦ç­‰ç­‰ï¼Œé‚£æˆ‘å€‘å…ˆæŠ“å‡º xy è»¸ï¼Œç„¶å¾Œè§€å¯Ÿé™„è¿‘ memory çš„å€¼çš„è®Šå‹•ï¼Œèªªä¸å®šèƒ½æ‰¾å‡ºäººç‰©ç§»å‹•é€Ÿåº¦ï¼Ÿï¼

é¦–å…ˆäººç‰©éš¨ä¾¿ç§»å‹•å¹¾ä¸‹ï¼Œéæ¿¾å‡º x è»¸ adrã€‚ç„¶å¾Œçœ‹ä¸€ä¸‹é™„è¿‘çš„å€¼ï¼Œé‚„çœŸçš„æœ‰è·Ÿæˆ‘å€‘å‰›å‰›çœ‹åˆ°ä¸€æ¨£æ˜¯ 0xB çš„ valueï¼Œè€Œä¸”æŒ‰ä¸‹ shift ä¹Ÿæœƒè®Šæˆ 0x9ï¼Œå¯èƒ½çœŸçš„è·Ÿé€Ÿåº¦æœ‰é—œï¼Œåœ¨é€™é‚Šå…ˆå¹«ä»–å‘½åç‚º speedã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-26.png 450 %}
ä½†æˆ‘å€‘èª¿æ•´ speed çš„å€¼ï¼Œäººç‰©çš„ç§»å‹•é€Ÿåº¦ä»ç„¶ä¸æœƒè®Šï¼Œè€Œä¸”æœƒè¢«æ”¹å› 0xBã€‚ä½¿ç”¨ä¸Šä¸€æ®µçš„æ–¹æ³•æ‰¾å‡ºè®€å–å¯«å…¥çš„ä»£ç¢¼æ®µï¼Œç™¼ç¾é‚„æ˜¯å›åˆ°äº†ç›¸åŒçš„åœ°æ–¹ `RGSS300.dll + 0x2D369`ï¼Œç ´é˜²...ã€‚

## åå‘æ‰¾å‡ºå„ register çš„å…§å®¹å’Œç›¸é—œçš„ä»£ç¢¼æ®µ
ç‚ºæ–¹ä¾¿ï¼Œåœ¨é€™é‚Šå…ˆæ”¾ä¸Š`RGSS300.dll + 0x2D34D` ~ `RGSS300.dll + 0x2D369` çš„ä»£ç¢¼æ®µ
```
RGSS300.dll+2D348 - jmp RGSS300.dll+2D1D6
RGSS300.dll+2D34D - mov eax,[esi+04] // æ®µè½çš„é–‹å§‹
RGSS300.dll+2D350 - mov ecx,[edx+04]
RGSS300.dll+2D353 - mov ebx,[edx+08]
RGSS300.dll+2D356 - mov edi,[eax-04]
RGSS300.dll+2D359 - add eax,-04
RGSS300.dll+2D35C - add edx,0C
RGSS300.dll+2D35F - mov [esi],edx
RGSS300.dll+2D361 - mov [esi+04],eax
RGSS300.dll+2D364 - mov esi,[esi+14]
RGSS300.dll+2D367 - push edi
RGSS300.dll+2D368 - push ecx
RGSS300.dll+2D369 - call RGSS300.dll+285E0
RGSS300.dll+2D36E - mov esi,[esp+3C]
RGSS300.dll+2D372 - add esp,08
RGSS300.dll+2D375 - jmp RGSS300.dll+2D1D6 // æ®µè½çš„çµæŸï¼Œè·³å› RGSS300.dll+2D1D6
```
ç¸½ä¹‹ï¼Œç›®æ¨™æ˜¯æ‰¾å‡ºåˆ°åº•å¾å“ªé‚Šé€²ä¾† `RGSS300.dll + 0x2D34D` çš„ï¼Œé€™æ¨£æˆ‘å°±æœ‰ç·šç´¢æ‰¾å‡º `edi = 0xB` ä¹‹å‰çš„ esiã€edx ç­‰ç­‰ register æ˜¯è¢«èª°åˆ†é…çš„ï¼Œç¶“éä¸€ç•ªå¿«é€Ÿçš„åˆ†æï¼Œå¤§æ¦‚å°±åƒä¸‹é¢ï¼Œæ„Ÿè¦ºé¡ä¼¼åšæŸä»¶äº‹æ™‚æœƒå‘¼å«å°æ‡‰çš„ func pointer(`RGSS300.dll + 0x2F598`) é€™æ¨£ã€‚

{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-27.png 450 %}

ä¸‹è¨˜æ†¶é«”å¯«å…¥æ–·é»ï¼Œè¿½å¯«å…¥ esi+4 (0x3DCB114) ä¸” condition æ˜¯ `readInterger(0x3DCB114) == 0xB` æ™‚çš„ä½ç½®ï¼Œæ‰¾åˆ°äº† `RGSS300.dll+2D26E`ã€‚
```
RGSS300.dll+2D241 - mov eax,[edx+08]
RGSS300.dll+2D244 - mov ecx,[edx+04] // 3. æƒ³è¨˜éŒ„ä¸‹ä¾†çš„å€¼
RGSS300.dll+2D247 - add edx,0C
RGSS300.dll+2D24A - mov [esi],edx
RGSS300.dll+2D24C - push eax
RGSS300.dll+2D24D - mov eax,[esi+18]
RGSS300.dll+2D250 - mov edx,ecx // 2. åœ¨é€™ä¸‹ AOB injectionï¼Œçœ‹çœ‹ edx + 0x4 å’Œ ecx çš„å€¼é€™æ™‚ç‚ºä½•ï¼Œå¦‚æœæ˜¯ 0xB å°±ä¸­äº†
RGSS300.dll+2D252 - mov ecx,[ebp+08]
RGSS300.dll+2D255 - call RGSS300.dll+28140 // 1. è£¡é¢æœ‰ä¸€å€‹ sar edx,1ï¼Œè¡¨ç¤ºå–å¾— edx/2ï¼Œæ¨æ¸¬ edx æ˜¯é—œéµå€¼
RGSS300.dll+2D25A - add esp,04
RGSS300.dll+2D25D - mov ecx,[esi+04]
RGSS300.dll+2D260 - lea edx,[ecx+000000B4]
RGSS300.dll+2D266 - cmp edx,esi
RGSS300.dll+2D268 - jae RGSS300.dll+2F48D
RGSS300.dll+2D26E - mov [ecx],eax // é€™è£¡å¯«å…¥äº† 0xB çš„å€¼çµ¦ç–‘ä¼¼æ˜¯ä»£è¡¨ normal speed çš„æš«å­˜è®Šæ•¸(0x3DCB114)
RGSS300.dll+2D270 - add dword ptr [esi+04],04
RGSS300.dll+2D274 - jmp RGSS300.dll+2D1D6

```
å¦‚ä¸‹ç‚ºé‡å° 2. çš„ AOB è…³æœ¬ï¼Œé€™è…³æœ¬åšçš„äº‹å°±æ˜¯é¡å¤–å®£å‘Šå…©å€‹è®Šæ•¸ï¼Œå°‡é€™ç¬é–“ ecx å’Œ edx+4 çš„å€¼å­˜ä¸‹ä¾†ï¼Œä»¥ä¾¿æ–·é»å‘½ä¸­æ™‚å¯ä»¥ç¢ºèªï¼Œä¸ç„¶å€¼æœƒè¢«å¾Œä¾†çš„æŒ‡ä»¤æ”¹æ‰ã€‚
- AOB 
```
[ENABLE]
aobscanmodule(HookSpeedAlloc_lv2,RGSS300.dll,8B D1 8B 4D 08 E8 E6) // should be unique
alloc(newmem,$1000)
alloc(variables, 0x100)

label(ecx_val)
label(edx_add_4_val)
label(code)
label(return)

variables:
ecx_val:
  dd 0
edx_add_4_val:
  dd 0

newmem:
  mov [ecx_val], ecx
  mov [edx_add_4_val], edx
  add [edx_add_4_val], 4
code:
  mov edx,ecx
  mov ecx,[ebp+08]
  jmp return

HookSpeedAlloc_lv2:
  jmp newmem
return:
registersymbol(HookSpeedAlloc_lv2)

[DISABLE]

HookSpeedAlloc_lv2:
  db 8B D1 8B 4D 08

unregistersymbol(HookSpeedAlloc_1v2)
dealloc(newmem)
dealloc(ecx_val,$4)
dealloc(edx_add_4_val,$4)

```
- (æˆ–è€…ä¹Ÿå¯ä»¥ç”¨ CE è·‘ lua è…³æœ¬ï¼Œå¤§æ¦‚çš„å¯«æ³•åƒä¸‹é¢é€™æ¨£)
``` lua
// é€™æ˜¯æˆ‘ä¹‹å‰æ‹¿ä¾†è¿½è§’è‰²ç‹€æ…‹å¯«çš„è…³æœ¬
character = 0
function debugger_onBreakpoint()
    if (EIP == 0x1008D272 ) then
      character = ESI
    end

    if(EIP == 0x1008D28E) then

        if(ESI==0x1445dff8) then
            printf("tirma: 0x%x",character)
            return 1
        end        
    end
    return 0        
end
debug_setBreakpoint(0x1008D272)
debug_setBreakpoint(0x1008D28E)
```

ä½†æ˜¯ï¼Œä¸‹æ–·é»å¾Œæˆ‘ç™¼ç¾å®Œå…¨æ²’å‘½ä¸­éï¼Œé æ¯ï¼ŒåŸä¾† 2. é€™é‚Šæ ¹æœ¬ä¸æœƒè¢«èµ°åˆ°ã€‚

å¤šä¸‹äº†å¹¾æ¬¡æ–·é»åè¿½ä»£ç¢¼æ®µå¾Œï¼Œæ„Ÿè¦ºæ‡‰è©²æ˜¯ä¸‹é¢é€™æ¨£å­ï¼Œå¯¦éš›æ˜¯å¾ `RGSS300.dll+2D25D` é–‹å§‹ã€‚
```
RGSS300.dll+2D25D - mov ecx,[esi+04] // å¾é€™é‚Šé–‹å§‹æœƒè¢«èµ°åˆ°
RGSS300.dll+2D260 - lea edx,[ecx+000000B4]
RGSS300.dll+2D266 - cmp edx,esi
RGSS300.dll+2D268 - jae RGSS300.dll+2F48D
RGSS300.dll+2D26E - mov [ecx],eax // é€™è£¡å¯«å…¥äº† 0xB çš„å€¼çµ¦ç–‘ä¼¼æ˜¯ä»£è¡¨ normal speed çš„æš«å­˜è®Šæ•¸(0x3DCB114)
RGSS300.dll+2D270 - add dword ptr [esi+04],04
RGSS300.dll+2D274 - jmp RGSS300.dll+2D1D6 // å›å»ä¸€é–‹å§‹
```

## éœæ…‹é€†å‘
é‚£`RGSS300.dll+2D25D`æ˜¯å¾å“ªè£¡ jmp éä¾†çš„å‘¢ï¼Ÿç¿»äº†ä¸€é func pointers (`RGSS300.dll + 0x2F598`)çš„å…§å®¹ï¼Œæ²’æœ‰ pointer çš„å€¼æ˜¯ `0x102D25D` ï¼Œçœ‹ä¾†æ˜¯ç„¡æ³•çŸ¥é“æ˜¯å“ªè£¡ä¾†çš„äº†...åªå¥½å¬å–šå‡ºå¥½æœ‹å‹ IDA ä¾†çœ‹ä¸€ä¸‹ cross reference äº†ã€‚

é¦–å…ˆç”¨ x32dbg çš„ Scylla æŠŠ module(RGSS300.dll) ç•¶å‰çš„è¨˜æ†¶é«” dump ä¸‹ä¾†ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-38.png 450 %}

> è¦ç‰¹åˆ¥å¾è¨˜æ†¶é«” dump çš„åŸå› æ˜¯å¦‚æœç›´æ¥æŠŠ RGSS300.dll ä¸Ÿçµ¦ IDAï¼Œæœƒç™¼ç¾`RGSS300.dll+2D25D`é€™é‚Šçš„æŒ‡ä»¤éƒ½é‚„æ²’è¢«è¼‰å…¥ï¼Œé€™æ˜¯ runtime æ‰æœƒè¼‰å…¥çš„å¯¦ä½œå…§å®¹ã€‚

é¤µçµ¦ IDAï¼Œå¾—åˆ°é€™é‚Šçš„ cross reference äº†ã€‚

```
seg000:1002D25D loc_1002D25D:                           ; CODE XREF: sub_1002D1C0+1E3â†“j
seg000:1002D25D                                         ; sub_1002D1C0+59Dâ†“j ...
seg000:1002D25D                 mov     ecx, [esi+4]
seg000:1002D260                 lea     edx, [ecx+0B4h]
seg000:1002D266                 cmp     edx, esi
seg000:1002D268                 jnb     loc_1002F48D
seg000:1002D26E
seg000:1002D26E loc_1002D26E:                           ; CODE XREF: sub_1002D1C0+254â†“j - 0x1002D409
seg000:1002D26E                                         ; sub_1002D1C0+2D2â†“j - 100 - 0x1002D492
seg000:1002D26E                 mov     [ecx], eax
seg000:1002D270                 add     dword ptr [esi+4], 4
seg000:1002D274                 jmp     loc_1002D1D6

```
è‡³æ–¼ IDA decompile å¾Œçš„çµæœæˆ‘å°±æ²’é™„ä¸Šäº†ï¼Œå¤§æ¦‚å°±æ˜¯é€™ä¼¼ä¹æ˜¯å€‹è¶…é•·ä¸€ä¸²çš„ while + switch loopï¼Œå› ç‚ºå¯¦åœ¨å¤ªé•·ä¸€å¤§ä¸²ï¼Œæˆ‘è‡ªèªæä¸æ‡‚å°±å…ˆä¸çœ‹äº†ã€‚

å…ˆå°ç›¸é—œçš„ä»£ç¢¼æ®µä¸‹å¹¾å€‹æ¢ä»¶æ–·é»ã€‚
- å° 0x1002d409 ä¸‹æ¢ä»¶æ–·é» EAX == 0xBï¼Œæ–·ä¸åˆ°ã€‚
- å° 0x1002d492 ä¸‹æ¢ä»¶æ–·é» EAX == 0xBï¼Œæ–·ä¸åˆ°ã€‚
- å° 0x1002d268 ä¸‹æ¢ä»¶æ–·é» EAX == 0xBï¼Œæ–·ä¸åˆ°ã€‚

wtf...é€™ä»€éº¼éˆç•°ç¾è±¡ï¼Œæ€éº¼éƒ½æ–·ä¸åˆ°çš„ naï¼Ÿ

## å¾äººç‰© x è»¸ address åˆ‡å…¥ (again)

{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-28.png 450 %}
å› ç‚ºè¿½ä¸å‡ºç”šéº¼çµæœï¼Œæˆ‘æ±ºå®šé‡æ–°ä¾†ï¼Œèªªä¸å®š 0xB é€™å€‹å€¼æ ¹æœ¬å°±éŒ¯äº†ï¼Œå…¶å¯¦é€Ÿåº¦ä¸æ˜¯ 0xB = =ã€‚
é‡æ–°å†æ‰¾äº†ä¸€æ¬¡ x è»¸ï¼Œé€™ä¸€æ¬¡ï¼Œå…ˆé–å€¼ç¢ºèªé€™å€‹ x è»¸çœŸçš„ workï¼Œç„¶å¾Œçœ‹äº†ä¸€ä¸‹åœ°å€ `0x10FE5D94`ï¼Œå—¯?!å°ç…§ `RGSS300.dll` çš„ module base `0x10000000`ï¼Œé€™ address å¥½åƒæ˜¯åœ¨ `RGSS300.dll` memory æ®µä¸­è€¶ï¼Œé›£é“å…¶å¯¦ x è»¸ä¹‹é¡çš„ info æ˜¯ module çš„ global variable å—? é‚£æˆ‘å‰›å‰›æ‰¾åˆ°çš„ x è»¸è«éæ˜¯ tmp varï¼Ÿæœƒä¸æœƒä¹‹å‰æ‰¾éŒ¯ç›®æ¨™äº†ï¼Œçœ‹ä¸€ä¸‹å‘¨é­ memory çš„è®ŠåŒ–ï¼Œäº‚è©¦ä¸€ä¸‹ã€‚

çµæœç™¼ç¾ +1C çš„è®Šæ•¸ä»£è¡¨é€Ÿåº¦...ï¼Œæ”¹æˆ 0xBã€0xD ä¹‹é¡çš„å€¼å¾Œï¼Œäººç‰©é€Ÿåº¦çœŸçš„æœƒè®Šå¿«ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-29.png 450 %}

è‡³æ­¤å®Œæˆäº†äººç‰©é€Ÿåº¦ä½ç½®çš„å°‹æ‰¾ã€‚å®šä½åˆ°å¯¦éš›çš„ pointer å¾Œå°±å¯ä»¥åŠ ä¸€äº›å°åŠŸèƒ½äº†ï¼Œä¾‹å¦‚è¨­å®š hotkey æ–¹ä¾¿éš¨æ™‚èª¿æ•´è‡ªå·±çš„ç§»å‹•é€Ÿåº¦ä¹‹é¡çš„ã€‚

# ä¿®æ”¹ç§»å‹•é€Ÿåº¦ (cont'd)
è€å¿ƒçœ‹åˆ°é€™é‚Šçš„å„ä½ï¼Œå¿ƒè£¡æ‡‰è©²åœ¨æƒ³ï¼š"æ€éº¼å¯èƒ½é€™éº¼æœƒçŒœï¼Œé‚„éƒ½çµ¦ä½ çŒœä¸­ï¼Œé€šéˆæ ¡éšŠå–”ï¼Ÿä½ é€™æ„Ÿè¦ºå¾ˆå¤§ä¸€éƒ¨åˆ†éƒ½åƒè³½åˆ°çš„ï¼Œé‹æ°£æµçš„æ˜¯ä¸æ˜¯ï¼Ÿ"ã€‚
æ²’éŒ¯ï¼Œå…¶å¯¦ç•¶åˆåœ¨ä¸Šä¸€ç« ç¯€ä¸­ï¼Œæˆ‘åœ¨åè¿½ `0xB` é€™å€‹ä»£è¡¨äººç‰©é€Ÿåº¦çš„å€¼åˆ°åº•å“ªè£¡ä¾†çš„æ™‚å€™ï¼Œå°±å¡é—œå¡åˆ°æ”¾æ£„äº† (è€Œä¸”äº‹å¯¦é€Ÿåº¦ä¹Ÿä¸æ˜¯ 0xB...æ˜¯ 0x9)ã€‚æ”¾æ£„çš„åŸå› æ˜¯æˆ‘å°æ•´å€‹éŠæˆ²æ©Ÿåˆ¶çš„å¯¦ä½œè™•ç†çœŸçš„æ²’æœ‰æ¦‚å¿µï¼Œé™¤äº†ä¸ç¢ºå®šè‡ªå·±éæ¿¾å‡ºçš„å€¼å°ä¸å°ï¼Œæƒ³è¦å¾€å›è¿½ä¹Ÿä¸çŸ¥é“è¦å¾€å“ªè£¡è¿½ã€‚é€†å‘éçš„æ‡‰è©²å¿ƒæœ‰æˆšæˆšç„‰(å§ï¼Ÿ)ï¼Œé‡åˆ°å‹•æ…‹åˆ†ææ™‚å¤§æµ·æ’ˆé‡çš„ä¸ç¢ºå®šæ„Ÿï¼Œä»¥åŠéœæ…‹åˆ†æ (e.g. IDA) é‚£ç¡¬æ ¸çš„çµ„èªå’Œ decompiled c++ å…§å®¹ï¼Œæˆ‘éƒ½åœ¨æƒ³æˆ‘æ˜¯ä¸æ˜¯åœ¨è‡ªè™ã€‚

æ‰€ä»¥æˆ‘æ”¾æ£„ç¡¬å‰›ï¼Œè½‰å‘ google æ‰¾å°‹å…¶ä»–å‡ºè·¯ã€‚
1. æœ `RGSS300 dll` æ™‚ï¼Œç™¼ç¾é€™å€‹éŠæˆ²æ˜¯ç”¨ RPG Maker VX Ace åšçš„
2. æœ `RPG Maker VX Ace Cheat` ä¹‹é¡çš„ï¼Œç™¼ç¾æœ‰äººå¯«äº†ä¸€å€‹ RMVA(RPG Maker VX Ace) ç”¨çš„ Cheater ([RMVA Cheat Menu](https://f95zone.to/threads/rpg-maker-vx-ace-cheat-menu.20567/) ([è¼‰é»](https://files.sakana.tw/Sequel-Blight-Reversing/RPG%20VX%20ACE%20Cheat%20System.7z)))

## RMVA Cheat Menu
    é€™æ’ä»¶çš„æœ¬åæ‡‰è©²å« RMVA Cheat System æ‰å°ï¼Œç´”ç²¹å› ç‚ºæ˜¯ä»–æœ‰ menuï¼Œæ‰€ä»¥æˆ‘éƒ½å«ä»– cheat menu æˆ– cheaterã€‚
é€™å€‹ Cheater å¤§æ¦‚é•·é€™æ¨£ï¼Œç¬¬ä¸€æ¬¡åŸ·è¡Œæ™‚æœƒå…ˆé€²è¡Œå®‰è£ Cheat Menuï¼Œæ¥ä¸‹ä¾†å°±å¯ä»¥ F8 å«å‡ºä½œå¼Šé¸å–®äº†ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-30.png 450 %}
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-31.png 450 %}

ä¾†äº†ï¼Œé€™å€‹ Cheater å°±æ˜¯æˆ‘çš„ç ”ç©¶ç›®æ¨™äº†ï¼Œè‡³å°‘ç ”ç©¶é€™å€‹æ±è¥¿æ€éº¼åšï¼Œæ‡‰è©²æ¯”é€†å‘éŠæˆ²æœ¬èº«é‚„ç°¡å–®å§ã€‚
åˆ†æˆå¹¾å€‹éšæ®µ
1. åˆæ­¥ç†è§£é€™ Cheater å…§å„æª”æ¡ˆçš„ä½œç”¨
2. ç ”ç©¶ç¬¬ä¸€æ¬¡åŸ·è¡Œçš„å®‰è£æ©Ÿåˆ¶ï¼ŒæŠ“å‡ºå®‰è£çš„å…§å®¹
3. ç†è§£é€™å€‹ Cheater å¦‚ä½•å¯¦ä½œçš„


## Cheater ä¸­å„æª”æ¡ˆçš„ä½œç”¨

```
.
â”œâ”€â”€ Data_Cheat
â”‚Â Â  â”œâ”€â”€ 002_Cheat_All.txt
â”‚Â Â  â”œâ”€â”€ 002_Cheat_Text_Cheat.txt
â”‚Â Â  â””â”€â”€ Scripts.rvdata2
â”œâ”€â”€ Game_Cheat.exe
â”œâ”€â”€ Game_cheat.ini
â””â”€â”€ System
    â””â”€â”€ RGSS301.dll
```
å…‰çœ‹æª”æ¡ˆåç¨±ï¼Œå¯ä»¥æ„Ÿå—åˆ° RGSS301.dll ä»¥åŠ Data_Cheat ä¸‹çš„æª”æ¡ˆ 002_Cheat_All.txtã€002_Cheat_Text_Cheat.txtã€Scripts.rvdata2 æ‡‰è©²æ˜¯æ”¾ä½œå¼ŠåŠŸèƒ½çš„å¯¦ä½œã€‚
è€Œ Game_cheat.exeã€Game_cheat.iniã€ä¸æ’é™¤æ˜¯é‡æ–°åŒ…è£éçš„éŠæˆ²å…¥å£é»ï¼Œæ˜¯ç‚ºäº†æˆåŠŸè¼‰å…¥ Data_Cheat çš„å…§å®¹è€Œé™„ä¸Šçš„ã€‚


### Game_cheat.exeã€Game_cheat.ini
Game_cheat.ini å…§å®¹
``` ini
[Game]
RTP=RPGVXAce
Library=System\RGSS301.dll
Scripts=Data_Cheat\Scripts.rvdata2
Title= RPG VX ACE Cheat System : dldb.info/blog/506
```

å‰›å¥½éŠæˆ²æœ¬èº«ä¹Ÿæœ‰ä¸€å€‹ Game.iniï¼Œå°æ¯”ä¸€ä¸‹
``` ini
[Game]
RTP=RPGVXAce
Library=System\RGSS300.dll
Scripts=Data\Scripts.rvdata2
Title=SEQUEL blight ver.2.10
Description=(no description)
CreationDate=1401520961
```
çœ‹èµ·ä¾† Game_cheat.ini æ˜¯ç”¨ä¾†æŒ‡å®š `Game_Cheat.exe` è¼‰å…¥ Cheater ç›¸é—œæ¨¡çµ„çš„ã€‚(e.g. `RGSS301.dll`ã€`Scripts.rvdata2`)
å’¦ï¼Ÿæ„Ÿè¦º Game_Cheat.exe æ˜¯ä¸æ˜¯æ²’æœ‰ç”¨å•Šï¼Ÿè©¦è©¦å°‡éŠæˆ²è‡ªå¸¶çš„ Game.exe æ”¹åæˆ `Game_Cheat.exe` åŸ·è¡Œçœ‹çœ‹ï¼Œä½œå¼Šçš„æ•ˆæœç¢ºå¯¦æ²’æœ‰å½±éŸ¿ã€‚

ç¸½çµä¸€ä¸‹ï¼ŒGame_Cheat.exe == Game.exeï¼Œè€Œè¼‰å…¥è¨­å®šæª”çš„è¡Œç‚ºå¦‚ä¸‹ï¼Œçœ‹èµ·ä¾†æ˜¯ä¾æ“šä¸»ç¨‹å¼çš„æª”åä¾†æ±ºå®šçš„ã€‚
- åŸ·è¡Œ Game_Cheat.exe æœƒè¼‰å…¥ Game_Cheat.ini
- åŸ·è¡Œ Game.exe æœƒè¼‰å…¥ Game.ini
- Game.exe æ”¹åæˆ Game123.exe æœƒç›´æ¥é–‹ä¸äº†

å…·é«”å¯åƒè€ƒ [RGSS è§„æ ¼](http://miaowm5.github.io/RMVA-F1/RPGVXAcecn/rgss/rgss.html)ï¼Œé€™ç¯‡å° RGSS3 åŒ…æ‹¬ `Game.ini` åšäº†ç°¡å–®çš„ä»‹ç´¹ã€‚

### RGSS301.dll
éŠæˆ²æœ¬èº«è‡ªå¸¶çš„ç‚º RGSS300.dllï¼Œè·Ÿé€™å€‹ RGSS301.dll æœ‰å•¥å·®åˆ¥å‘¢ï¼Œç›´æ¥é¤µç‹—ä¼¼ä¹åªå·®åœ¨èªè¨€è€Œå·²ã€‚
- 300 = æ—¥æ–‡ç‰ˆå’Œæ±‰åŒ–æ—¥æ–‡ç‰ˆ
- 301 = è‹±æ–‡ç‰ˆ

å°‡ Game_cheat.ini çš„ Library æ”¹ç‚º `System\RGSS300.dll` å¾Œï¼Œä»ç„¶èƒ½æ­£å¸¸é‹ä½œï¼Œçœ‹èµ·ä¾† dll ä¹Ÿæ˜¯ä¸å½±éŸ¿çš„ã€‚ç”šè‡³ç›´æ¥ä½¿ç”¨ [RMVA](https://www.rpgmakerweb.com/products/rpg-maker-vx-ace) ç”¢ç”Ÿä¸€å€‹ demo éŠæˆ²ï¼Œå°‡ç”¢ç”Ÿçš„éŠæˆ²åŒ…ç•¶ä¸­çš„ Game.exe å’Œ RGSS301.dll æ‹¿ä¾†ç”¨éƒ½å¯ä»¥ã€‚
åœ¨ä½¿ç”¨ RMVA ç”¢ç”ŸéŠæˆ²çš„åŒæ™‚ï¼Œæˆ‘ä¹Ÿç¢ºå®šäº†é€™å€‹éŠæˆ²å¼•æ“çš„æ”¯æ´èªè¨€æ˜¯ rubyï¼Œæ¨æ¸¬ RGSS300.dll å°±æ˜¯ç”¨ä¾†è¼‰å…¥ ruby è…³æœ¬ä¹‹é¡çš„ dll æ¨¡çµ„ã€‚

åƒè€ƒè³‡æ–™ï¼š[[å·²ç»è§£å†³] å…³äºRGSS301.dll ä»¥åŠæ›´é«˜ç‰ˆæœ¬çš„dll](https://rpg.blue/thread-411720-1-1.html)

### 002_Cheat_All.txtã€002_Cheat_Text_Cheat.txtã€Scripts.rvdata2
åƒè€ƒ [RGSS è§„æ ¼](http://miaowm5.github.io/RMVA-F1/RPGVXAcecn/rgss/rgss.html)ï¼Œ`Scripts.rvdata2` æ˜¯åŠ å¯†å¾Œçš„ç¨‹å¼é‚è¼¯ã€‚è‡³æ–¼`002_Cheat_All.txt`ã€`002_Cheat_Text_Cheat.txt`ï¼Œå¿«é€Ÿå–µäº†ä¸€ä¸‹æ‡‰è©²æ˜¯ä½œå¼Šé¸å–®é‚è¼¯ï¼Œèªè¨€æ²’æ„å¤–æ˜¯ rubyã€‚

### é‡é»æ•´ç†
1. Game_Cheat.exe å’Œ RGSS301.dll è·ŸéŠæˆ²æœ¬é«”å…§å®¹æ²’æœ‰å·®åˆ¥ï¼Œè€Œ Game_Cheat.ini å‰‡æ˜¯ç”¨ä¾†æŒ‡å®šè¼‰å…¥æ¨¡çµ„ï¼Œè·Ÿä½œå¼Šé¸å–®æœ¬èº«ç„¡é—œã€‚
2. `Scripts.rvdata2`ã€`002_Cheat_All.txt`ã€`002_Cheat_Text_Cheat.txt` æ‡‰æ˜¯ä½œå¼Šé¸å–®çš„æ ¸å¿ƒå¯¦ä½œ

## æ‹†è§£å®‰è£æ©Ÿåˆ¶åŠå…§å®¹
ç”±å…ˆå‰æ•´ç†çš„è³‡è¨Šï¼Œæ¥ä¸‹ä¾†é‡é»å°‡æœƒæ”¾åœ¨åˆ†æ `Scripts.rvdata2`ã€`002_Cheat_All.txt`ã€`002_Cheat_Text_Cheat.txt` ä¸Šã€‚

ç¬¬ä¸€æ¬¡åŸ·è¡Œçš„å®‰è£æ“ä½œæ‡‰è©²æ˜¯ `Scripts.rvdata2` çš„è¡Œç‚ºã€‚
è§£å¯† rvdata2 çš„å…§å®¹å¯ä»¥ä½¿ç”¨
1. ä½¿ç”¨äººå®¶å¯«çš„ vim plugin
	- [RGSS Script Editor Plugin - An RGSS Editor Plugin : vim online](https://www.vim.org/scripts/script.php?script_id=4367)
    - ç¶²é å¥½åƒæ›äº†ï¼Œæœ€è¿‘çœ‹æ˜¯æ²’è¾¦æ³•æŠ“
2. è‡ªå·±å¯«ä¸€å€‹ RMVA çš„ ruby è…³æœ¬é€²è¡Œè®€å–
	- (é€™æ˜¯é€†å‘ Cheater ä¸­ `Scripts.rvdata2` çš„å¯¦ä½œå¾Œç™¼ç¾çš„ï¼Œä½¿ç”¨ RGSS::load_data + Zlib::inflate)
	- [Method: RGSS#load_data â€” Documentation for openrgss (0.1.5) (rubydoc.info)](https://www.rubydoc.info/gems/openrgss/RGSS:load_data)
3. ä½¿ç”¨äººå®¶å¯«çš„å°ˆæ¡ˆ [rvpacker](https://github.com/Solistra/rvpacker)
    - æˆ‘å¼„äº†ä¸€å€‹å°æ™‚å°±æ˜¯çŒä¸èµ·ä¾†ï¼Œæ”¾æ£„ã€‚æ¨æ¸¬æ˜¯é€™å€‹å°ˆæ¡ˆæ”¯æ´çš„ ruby ç‰ˆæœ¬å¤ªèˆŠã€‚
4. æ‹¿ RMVA å…§å»ºçš„ç·¨è¼¯å™¨ä¾†ç”¨
    - å»ºç«‹éŠæˆ²å°ˆæ¡ˆå¾Œï¼Œç›´æ¥æŠŠ `Scripts.rvdata2` è¤‡è£½ä¸€ä»½å–ä»£éŠæˆ²å°ˆæ¡ˆä¸­çš„ç‰ˆæœ¬ï¼ŒæŠŠè…³æœ¬ç·¨è¼¯å™¨æ‰“é–‹å¾Œå°±èƒ½è¦‹åˆ°è§£å¯†å¾Œçš„ `Scripts.rvdata2` å…§å®¹äº†ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-32.png 450 %}

ä»¥ä¸Šå¹¾ç¨®æ–¹æ³•æˆ‘éƒ½è©¦éï¼Œæˆ‘è¦ºå¾— 4. æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œæœ€ä¸ç”¨æƒé›·é™¤éŒ¯ = =ã€‚é™„ä¸Šæ‹†å‡ºä¾†çš„è…³æœ¬ï¼Œ
``` ruby
if FileTest.exist?("002_Cheat.txt")
  change_script_name = File.read("002_Cheat.txt")
else
  change_script_name = false
end

change_script_text_1 = false
change_script_text_2 = false

if FileTest.exist?("Data_Cheat/002_Cheat_All.txt")
  file = File.open("Data_Cheat/002_Cheat_All.txt")
  change_script_text_1 = file.read
  file.close
end

if FileTest.exist?("Data_Cheat/002_Cheat_Text_Cheat.txt")
  file = File.open("Data_Cheat/002_Cheat_Text_Cheat.txt")
  change_script_text_2 = file.read
  file.close
end

change_text = []
change_text[0] = ["Data/Items.rvdata2","Data_Cheat/Items.rvdata2"]

  def inflate(string)
    zstream = Zlib::Inflate.new()
    buf = zstream.inflate(string)
    zstream.finish
    zstream.close
    buf
  end
  def deflate(string, level = Zlib::BEST_COMPRESSION)
    z = Zlib::Deflate.new(level)
    dst = z.deflate(string, Zlib::FINISH)
    z.close
    dst
  end

  $cheat_scripts = load_data("Data/Scripts.rvdata2")
  k = 0
  k2 = 0
  $cheat_save_scripts = []
  
  $cheat_scripts.each do |unScript |
    k = k + 1
    nom = unScript[1]
    code = inflate(unScript[2])
      
    code.gsub!("\x0D\n") { "\n" }
    @file = File.open("009_script.txt","w")
    @file.write(code)
    @file.close
    @file = File.open("009_script.txt","r")
    code = @file.read
    @file.close
    for i in change_text
      code.gsub!( i[0] ) { i[1] }
    end
    if change_script_name
      if unScript[1] == change_script_name
        msgbox(change_script_name + " Cheat Add")
        $cheat_save_scripts.push(["","",deflate(change_script_text_1)]) if change_script_text_1
        $cheat_save_scripts.push(["","",deflate(change_script_text_2)]) if change_script_text_2
      end
    else
      code.gsub(/[   ]*rgss_main \{ SceneManager.run \}/) do
        msgbox(unScript[1] + " Cheat Add")
        $cheat_save_scripts.push(["","",deflate(change_script_text_1)]) if change_script_text_1
        $cheat_save_scripts.push(["","",deflate(change_script_text_2)]) if change_script_text_2
      end
    end
    
    $cheat_save_scripts.push(unScript)
  end
      
  save_data($cheat_save_scripts, "Data_Cheat/Scripts.rvdata2")
```

ç°¡å–®ä¾†èªªï¼Œé€™éƒ¨åˆ†åšçš„äº‹æƒ…æ˜¯å°‡ `Data_Cheat/002_Cheat_All.txt` å’Œ `Data_Cheat/002_Cheat_Text_Cheat.txt` çš„å…§å®¹ä¸²æ¥åˆ°éŠæˆ²åŸæœ¬çš„ `Data/Scripts.rvdata2` å¾Œï¼Œè®Šæˆä¸€å€‹æ–°çš„ `Data_Cheat/Scripts.rvdata2`ã€‚
ä¸å¾—ä¸èªªï¼Œæˆ‘è¦ºå¾—é€™å€‹æ–¹æ³•è »é«˜æ˜çš„ï¼Œç„¡ç—›çš„åœ¨éŠæˆ²æœ¬èº«çš„å…§å®¹ä¸ŠåŠ å…¥è‡ªå·±çš„æ–°æ±è¥¿ã€‚è‹¥ä½¿ç”¨è€…å¾Œä¾†ä¸æƒ³ç”¨é€™ä½œå¼ŠåŠŸèƒ½ï¼Œæ”¹ç‚ºåŸ·è¡Œ Game.exe å°±å¯ä»¥äº†ã€‚

## ä½œå¼Šé¸å–®çš„å¯¦ä½œ
ç¸½ç®—åˆ°ç†è§£å¯¦ä½œçš„ç’°ç¯€äº†ï¼Œé›–ç„¶ä¸€é–‹å§‹çš„ç›®æ¨™æ˜¯ä¿®æ”¹äººç‰©é€Ÿåº¦ï¼Œä½†æˆ‘åŒæ¨£å¾ˆå¥½å¥‡ä»–ä¸€äº›åŠŸèƒ½æ˜¯æ€éº¼å¯¦ç¾çš„ï¼Œæ‰€ä»¥å¤šè¨‚äº†å¹¾å€‹ç›®æ¨™
1. å¦‚ä½•æŠŠä½œå¼Šé¸å–®è¼‰å…¥åˆ°éŠæˆ²ä¸­
2. çœ‹çœ‹äººç‰©é€Ÿåº¦æ€éº¼æ”¹çš„

### å°‡é¸å–®è¼‰å…¥åˆ°éŠæˆ²ä¸­
æœå°‹å«å‡ºä½œå¼Šé¸å–®çš„æŒ‰éµ `F8`ï¼Œå¯çŸ¥ç•¶æŒ‰éµæŒ‰ä¸‹æ™‚ï¼Œæœƒäº¤ç”± `Scene_Map` è™•ç†ï¼Œå¤§æ¦‚æ˜¯åšäº†é€™å¹¾ä»¶äº‹ï¼Œ
1. åˆå§‹åŒ–ä½œå¼Šé¸å–®çš„è¦–çª— (e.g. `Scene_Cheat`, `Window_CheatCommand`)
2. è¨­å®šæ¯å€‹é¸é …å€‹åˆ¥çš„ handleï¼Œç•¶é¸æ“‡å°æ‡‰çš„é¸é …æ™‚ï¼Œå…¶ handle æœƒå‰µå»ºæ–°çš„å­é¸å–®ä¸¦å¥—ç”¨è¨­å®šã€‚ (e.g. `Scene_Cheat`, `set_handler`)

{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-33.png 450 %}
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-34.png 450 %}

ä¸éï¼Œç•¶å»æ¯”å°éŠæˆ²æœ¬é«”çš„è…³æœ¬å…§å®¹æ™‚ï¼Œæœƒç™¼ç¾ `Scene_Map` æ˜¯æœ¬ä¾†å°±æœ‰çš„ classã€‚
å¦‚æœè·Ÿæˆ‘ä¸€æ¨£åªæœ‰å¯«é c++ã€python ä¹‹é¡çš„æœ‹å‹ï¼Œæ‡‰è©²æœƒé»‘äººå•è™Ÿï¼Œé‡è¤‡å®šç¾© class æœƒå™´éŒ¯å§ï¼Ÿå…¶å¯¦é€™å€‹æ“ä½œåœ¨ ruby å«åš [open class](https://stackoverflow.com/questions/3822471/are-you-allowed-to-redefine-a-class-in-ruby-or-is-this-just-in-irb)ï¼Œå¯ä»¥å¾€å·²ç¶“å®šç¾©å¥½çš„ class ä¸­æ‰“ patchï¼Œå¤ªæ·«è•©äº†...ã€‚
å„˜ç®¡èº«ç‚º c++ é–‹ç™¼è€…çš„æˆ‘ç„¡æ³•é©æ‡‰é€™å€‹ç‰¹æ€§ï¼Œç”šè‡³é‚„æƒ³å¿˜è¨˜æˆ‘çœ‹äº†ä»€éº¼ï¼Œä½†ä¹Ÿç¢ºå¯¦æ˜¯æœ‰äº†é€™å€‹ç‰¹æ€§ï¼Œé€™å€‹ä½œå¼Šè…³æœ¬æ‰èƒ½åœ¨ä¿ç•™éŠæˆ²åŸå…ˆé‚è¼¯çš„å‰æä¸‹åŠ æ±è¥¿ï¼Œç‰›é€¼ã€‚

### èª¿æ•´äººç‰©é€Ÿåº¦çš„é¸é …
ç¿»äº†ä¸€éè·Ÿ speed é¸å–®æœ‰é—œçš„å¯¦ä½œï¼ŒåŸºæœ¬ä¸Šæµç¨‹æ˜¯é€™æ¨£çš„
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-35.png 450 %}
1. é–‹å•Ÿ "Move Speed" é¸å–®ï¼Œå‘¼å« edit_move command (æ­¤ command ext = "move")ã€‚
2. edit_move å‘¼å« Window_ChaatMove è™•ç†è¨­å®šé€Ÿåº¦ (4~9) çš„é¸é …ï¼Œåœ¨é€™é‚Šé¸é …æ˜¯ 4ã€‚
3. Window_CheatMove å‘¼å« cheat_change("move", 4)ï¼Œè¨­å®šé€Ÿåº¦å€¼ã€‚
4. cheat_change è·Ÿæ“šå‚³å…¥çš„ ext ä¾†è¨­å®šå°æ‡‰çš„å±¬æ€§å€¼ï¼Œåœ¨é€™é‚Šè¨­å®š `@move = 4`ã€‚

å¤§è‡´äº†è§£é¸å–®çš„é‚è¼¯å¾Œï¼Œé–‹å§‹è¿½ move å€¼çš„æ”¹å‹•æœƒå¦‚ä½•å¥—ç”¨åˆ°éŠæˆ²äººç‰©ä¸Šï¼Œé€™éƒ¨åˆ†è »å–®ç´”çš„ï¼Œå°±æ˜¯è¦†å¯«åŸæœ¬çš„ `real_move_speed`ï¼Œæ”¹ç‚ºä½¿ç”¨ä½œå¼Šé¸å–®è¨­å®šçš„ move å€¼ã€‚(ä¸‹åœ–å·¦ç‚ºä½œå¼Šé¸å–®ï¼Œåœ–å³ç‚ºåŸæœ¬é‚è¼¯)
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-36.png 450 %}
(åŸæœ¬çš„`real_move_speed`è·Ÿæˆ‘åœ¨ä½¿ç”¨ CE é€†å‘æ™‚çš„çŒœæ¸¬ä¹‹ä¸€è »æ¥è¿‘çš„ï¼Œé‚„çœŸçš„æ˜¯äººç‰©é€Ÿåº¦ +1ï¼Œå†ç´°è¿½ä¸€ä¸‹æœƒç™¼ç¾é€™å€‹å€¼ä¸»è¦å½±éŸ¿æ¯ä¸€å¹€æ›´æ–°æ™‚äººç‰©çš„ç§»å‹•è·é›¢ã€‚)

## å›åˆ° CE
ç›®å‰å·²ç¶“æœ‰å…©å€‹æ–¹æ³•å¯ä»¥é”æˆé€™ä»¶äº‹äº†
1. CE
2. Cheat Menu

è·Ÿä¸€é–‹å§‹ä¸ä¸€æ¨£çš„æ˜¯ï¼Œæˆ‘å€‘æ‰‹ä¸Šæœ‰ source äº†ï¼Œåœ¨ä½¿ç”¨ CE é€†å‘çš„éšæ®µæ™‚ï¼Œæœ‰å¾ˆå¤šä¸ç¢ºå®šçš„ struct memberï¼Œç¾åœ¨å¯ä»¥ç„¡æ¥çš„è·Ÿ src æ¯”å°ï¼Œ ä¸€å€‹ä¸€å€‹æ‰¾å‡ºé€™äº›å€¼åˆ°åº•æ˜¯å•¥ã€‚
ç›´æ¥ä¾†æ¯”å° `Game_CharacterBase` å’Œ CE çœ‹åˆ°çš„ struct å…§å®¹ã€‚
{% img https://files.sakana.tw/Sequel-Blight-Reversing/sequel-blight-37.png 450 %}
å¯è¦‹æ•¸å­—æ˜¯ä»¥ 2x + 1 å»å­˜ï¼Œè€Œ bool æ˜¯ä»¥ 2x å»å­˜ã€‚ä¸¦ä¸”æŠŠé€™äº›å€¼ç©ä¸€éä¹‹å¾Œï¼Œæˆ‘æ„Ÿè¦ºæ¯”è¼ƒå¯¦ç”¨çš„æœ‰ move speedã€through mode (ä¸æœƒæ’æ€ªã€ä¸å—éšœç¤™çš„ç§»å‹•)ã€‚

# ç¸½çµ
ä»¥ä¸Šå°±æ˜¯é€†å‘é€™éŠæˆ²çš„éç¨‹ã€‚
é€šéé€™ç¯‡æ–‡ï¼Œä¸å°ˆæ¥­çš„è¨˜éŒ„äº†ç”¨ CE é€†å‘éŠæˆ²çš„å„å€‹éšæ®µ
1. ä½¿ç”¨ CE æŠ“å‡ºè¨˜æ†¶é«”ä½ç½®
2. ä½¿ç”¨ CE åè¿½å¯«å…¥è®€å–çš„ç¨‹å¼æ®µ
3. ä½¿ç”¨ IDAã€x64dbg ç­‰å‹•æ…‹ã€éœæ…‹å·¥å…·è¼”åŠ©åˆ†æ
4. æ”¾æ£„åˆ†æï¼Œä½¿ç”¨é€šéˆï¼ŒçŒœåˆ°è³ºåˆ°

ä»¥åŠé€šéè’é›†è³‡è¨Šï¼Œå¾å…¶ä»–è§’åº¦åˆ‡å…¥ï¼Œç›¡é‡é¿é–‹ç¡¬å‰›è¨˜æ†¶é«”çš„æ–¹å¼
1. ç ”ç©¶å…¶ä»–äººå¯«å¥½çš„å·¥å…·
2. ç†Ÿæå°æ‡‰çš„éŠæˆ²å¼•æ“çš„å¤§è‡´é‹ä½œæ–¹å¼
3. é€šé 1ã€2 çš„è³‡è¨Šï¼Œå˜—è©¦ç”¨è¼ƒé«˜çš„å±¤æ¬¡ä¾†åˆ†æéŠæˆ²

# å¿ƒå¾—
ä¸€é–‹å§‹åªæ˜¯æƒ³èªªè¨˜éŒ„ä¸€ä¸‹ï¼Œå°‡è¿‘ä¸€å¹´å‰é€†é€™å€‹éŠæˆ²é€†çš„å¾ˆç—›è‹¦ï¼Œä¸åœæ’ç‰†çš„éç¨‹ã€‚

é›–ç„¶é€šé CE ç´”é€†å‘çš„æˆæœä¸¦ä¸æ˜¯å¾ˆå¥½ï¼Œä½†éç¨‹æˆ‘è¦ºå¾—é‚„ç®—æœ‰è¶£ï¼Œåƒæ˜¯è®Šæ•¸è¿½åˆ°ä¸€åŠé‚è¼¯å°±æ–·æ‰äº†æ€éº¼è¾¦ï¼Œå¦‚ä½•é€šé CE å¼·å¤§çš„å·¥å…·æ‰¾åˆ°å¯«å…¥é»ã€æ‰¾åˆ°è®Šæ•¸çœŸæ­£çš„æŒ‡æ¨™ä¹‹é¡çš„ï¼Œæœ‰ä¸å°‘å¯¦éš›åšä¹‹å‰éƒ½ä¸æœƒæƒ³åˆ°çš„é¨·æ“ä½œã€‚

ä½†é€†å‘çš„éç¨‹è¦è§£é‡‹æ¸…æ¥šçœŸçš„æ¯”æƒ³åƒä¸­é‚„å›°é›£ï¼Œå°±æˆ‘è‡ªå·±çš„æ„Ÿè¦ºï¼Œé€†å‘æ™‚æœƒä¸€ç›´æœ‰ä¸åŒæ”¯ç·šå†’å‡ºä¾†ï¼Œé‚„æœƒä¸åœçš„åšå‡è¨­ï¼Œæœ‰æ™‚å€™è¿½ä¸åŒåœ°æ–¹çš„é‚è¼¯æ™‚ï¼Œçªç„¶å°±ç™¼ç¾æ¥èµ·ä¾†äº†...é€™ç¨®çœ‹ä¼¼æ¯«ç„¡é‚è¼¯çš„äº‹ä¹Ÿæœƒç™¼ç”Ÿã€‚è¦ç”¨ä¸€ç›´ç·šçš„æ–‡ç« æ€è·¯è¨˜éŒ„ä¸‹ä¾†çœŸçš„æ˜¯é›£å€’æˆ‘ï¼Œå¯«åˆ°ä¸€åŠå°±æ„Ÿè¦ºè‡ªå·±é–‹éŒ¯å‘äº†ã€‚

ä¸éå¯«æ–‡ç« çš„éç¨‹ä¸­ä¹Ÿæ„å¤–ç²å¾—äº†ä¸€äº›æ”¶ç©«ï¼Œå› ç‚ºé€™ç¯‡æ˜¯ä¸€é‚Šå¯«ä¸€é‚Šé€†çš„ï¼Œå…¶å¯¦æœƒèŠ±æ›´å¤šçš„æ™‚é–“å¯©è¦–æ¯ä¸€æ­¥ï¼Œæ¯”è¼ƒç¢ºå®šåœ¨åšä»€éº¼ï¼Œå› ç‚ºæƒ³å¾—æ¯”è¼ƒä¹…ï¼Œä¹Ÿæœƒæƒ³åˆ°ä¹‹å‰åˆ†ææ™‚æ²’æƒ³åˆ°çš„æ“ä½œï¼Œè »ä¸éŒ¯çš„ã€‚

æƒ³èµ·ä»¥å‰æƒ³å­¸å¤–æ›ï¼Œé€›å¤–æ›è«–å£‡æ™‚çœ‹åˆ°æœ‰äº›äººå•å¤§ç¥ï¼Œäººç‰©ç„¡æ•µçš„åœ°å€åˆ°åº•æ€éº¼æ‰¾åˆ°çš„ï¼Œå¤§ç¥èªªé€™æ˜¯ä¸€å€‹æ„Ÿè¦ºï¼Œå¾ˆé›£è§£é‡‹ï¼Œç„¶å¾Œçœ‹èµ·ä¾†ä¹Ÿæ²’æ‰“ç®—è§£é‡‹XDã€‚æˆ‘å¿ƒè£¡å°±åœ¨æƒ³ "é åŒ—é˜¿ï¼Œåˆ°åº•æ˜¯ä»€éº¼æ„Ÿè¦ºï¼Œå¤©ç”Ÿçš„æ„Ÿè¦ºå—...æˆ‘çœŸçš„æ„Ÿè¦ºä¸åˆ°ä»»ä½•çš„æ„Ÿè¦ºè€¶..."ã€‚
å¯«é€™ç¯‡æ–‡ç« æ™‚çªç„¶æƒ³èµ·é€™äº‹ï¼Œå¦‚æœæœ‰è·Ÿæˆ‘ä¸€æ¨£æ‰¾ä¸åˆ°æ„Ÿè¦ºçš„æœ‹å‹ï¼Œå¸Œæœ›çœ‹å®Œé€™ç¯‡å¾Œèƒ½æ‰¾åˆ°ä¸€é»æ„Ÿè¦ºã€‚



